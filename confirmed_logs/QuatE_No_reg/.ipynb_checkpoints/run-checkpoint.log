2023-23-07 18:23:50 INFO     Saving logs in logs/03_07/FB15K/QuatE_18_23_50
2023-23-07 18:23:50 INFO     active_num = 10000
2023-23-07 18:23:50 INFO     batch_size = 1000
2023-23-07 18:23:50 INFO     counter = 10
2023-23-07 18:23:50 INFO     dataset = FB15K
2023-23-07 18:23:50 INFO     debug = False
2023-23-07 18:23:50 INFO     device = cuda
2023-23-07 18:23:50 INFO     diff_weight = 0.001
2023-23-07 18:23:50 INFO     dyn_scale = False
2023-23-07 18:23:50 INFO     expected_completion_ratio = 0.99
2023-23-07 18:23:50 INFO     hidden_size = 600
2023-23-07 18:23:50 INFO     incremental_learning_epoch = 20
2023-23-07 18:23:50 INFO     incremental_learning_method = retrain
2023-23-07 18:23:50 INFO     incremental_learning_rate = 0.001
2023-23-07 18:23:50 INFO     init_ratio = 0.9
2023-23-07 18:23:50 INFO     init_scale = 0.001
2023-23-07 18:23:50 INFO     max_batch_for_inference = 15000
2023-23-07 18:23:50 INFO     max_epochs = 100
2023-23-07 18:23:50 INFO     model = QuatE
2023-23-07 18:23:50 INFO     n_ent = 14951
2023-23-07 18:23:50 INFO     n_rel = 1345
2023-23-07 18:23:50 INFO     neg_size = -1
2023-23-07 18:23:50 INFO     optimizer = Adam
2023-23-07 18:23:50 INFO     patient = 5
2023-23-07 18:23:50 INFO     pretrain_learning_rate = 0.001
2023-23-07 18:23:50 INFO     pretrained_model_id = None
2023-23-07 18:23:50 INFO     reg_weight = 0.005
2023-23-07 18:23:50 INFO     regularizer = DURA_QuatE
2023-23-07 18:23:50 INFO     save_dir = logs/03_07/FB15K/QuatE_18_23_50
2023-23-07 18:23:50 INFO     setting = active_learning
2023-23-07 18:23:50 INFO     skip_phase_1 = False
2023-23-07 18:23:50 INFO     sta_scale = 1
2023-23-07 18:23:50 INFO     train_ratio = 0.9
2023-23-07 18:23:50 INFO     update_freq = -1
2023-23-07 18:23:50 INFO     valid_period = 5
2023-23-07 18:23:50 INFO     	 Loading dataset FB15K in active_learning setting, with shape (14951, 1345)
2023-23-07 18:23:54 INFO     Total number of parameters 10584600
2023-25-07 18:25:36 INFO     	 Do not specific a pretraiend model, then training from scratch.
2023-25-07 18:25:36 INFO     	 Start pretraining phase 1: on training split.
2023-25-07 18:25:54 INFO     	 Epoch 0 | average train loss: 6.5871
2023-25-07 18:25:54 INFO     	 Epoch 0 | average valid loss: 4.8766
2023-26-07 18:26:11 INFO     	 Epoch 1 | average train loss: 4.6139
2023-26-07 18:26:11 INFO     	 Epoch 1 | average valid loss: 4.2272
2023-26-07 18:26:29 INFO     	 Epoch 2 | average train loss: 3.9121
2023-26-07 18:26:29 INFO     	 Epoch 2 | average valid loss: 3.9296
2023-26-07 18:26:46 INFO     	 Epoch 3 | average train loss: 3.4777
2023-26-07 18:26:47 INFO     	 Epoch 3 | average valid loss: 3.7950
2023-27-07 18:27:04 INFO     	 Epoch 4 | average train loss: 3.2264
2023-27-07 18:27:05 INFO     	 Epoch 4 | average valid loss: 3.7359
2023-27-07 18:27:20 INFO     MRR: 0.492, Hits@1: 0.367, Hits@3: 0.566, Hits@10: 0.729 
2023-27-07 18:27:20 INFO     Best results updated, save current model.
2023-27-07 18:27:37 INFO     	 Epoch 5 | average train loss: 3.0863
2023-27-07 18:27:37 INFO     	 Epoch 5 | average valid loss: 3.7081
2023-27-07 18:27:55 INFO     	 Epoch 6 | average train loss: 3.0057
2023-27-07 18:27:55 INFO     	 Epoch 6 | average valid loss: 3.7088
2023-28-07 18:28:13 INFO     	 Epoch 7 | average train loss: 2.9564
2023-28-07 18:28:13 INFO     	 Epoch 7 | average valid loss: 3.7147
2023-28-07 18:28:31 INFO     	 Epoch 8 | average train loss: 2.9240
2023-28-07 18:28:31 INFO     	 Epoch 8 | average valid loss: 3.7351
2023-28-07 18:28:49 INFO     	 Epoch 9 | average train loss: 2.9018
2023-28-07 18:28:49 INFO     	 Epoch 9 | average valid loss: 3.7652
2023-29-07 18:29:04 INFO     MRR: 0.542, Hits@1: 0.421, Hits@3: 0.621, Hits@10: 0.765 
2023-29-07 18:29:04 INFO     Best results updated, save current model.
2023-29-07 18:29:21 INFO     	 Epoch 10 | average train loss: 2.8850
2023-29-07 18:29:21 INFO     	 Epoch 10 | average valid loss: 3.8064
2023-29-07 18:29:39 INFO     	 Epoch 11 | average train loss: 2.8724
2023-29-07 18:29:39 INFO     	 Epoch 11 | average valid loss: 3.8487
2023-29-07 18:29:57 INFO     	 Epoch 12 | average train loss: 2.8615
2023-29-07 18:29:57 INFO     	 Epoch 12 | average valid loss: 3.8987
2023-30-07 18:30:15 INFO     	 Epoch 13 | average train loss: 2.8530
2023-30-07 18:30:15 INFO     	 Epoch 13 | average valid loss: 3.9473
2023-30-07 18:30:33 INFO     	 Epoch 14 | average train loss: 2.8451
2023-30-07 18:30:33 INFO     	 Epoch 14 | average valid loss: 3.9989
2023-30-07 18:30:51 INFO     MRR: 0.547, Hits@1: 0.426, Hits@3: 0.624, Hits@10: 0.767 
2023-30-07 18:30:51 INFO     Best results updated, save current model.
2023-31-07 18:31:08 INFO     	 Epoch 15 | average train loss: 2.8379
2023-31-07 18:31:08 INFO     	 Epoch 15 | average valid loss: 4.0525
2023-31-07 18:31:26 INFO     	 Epoch 16 | average train loss: 2.8318
2023-31-07 18:31:26 INFO     	 Epoch 16 | average valid loss: 4.1072
2023-31-07 18:31:44 INFO     	 Epoch 17 | average train loss: 2.8267
2023-31-07 18:31:44 INFO     	 Epoch 17 | average valid loss: 4.1618
2023-32-07 18:32:02 INFO     	 Epoch 18 | average train loss: 2.8210
2023-32-07 18:32:02 INFO     	 Epoch 18 | average valid loss: 4.2143
2023-32-07 18:32:20 INFO     	 Epoch 19 | average train loss: 2.8166
2023-32-07 18:32:20 INFO     	 Epoch 19 | average valid loss: 4.2681
2023-32-07 18:32:36 INFO     MRR: 0.546, Hits@1: 0.426, Hits@3: 0.623, Hits@10: 0.765 
2023-32-07 18:32:54 INFO     	 Epoch 20 | average train loss: 2.8124
2023-32-07 18:32:54 INFO     	 Epoch 20 | average valid loss: 4.3168
2023-33-07 18:33:12 INFO     	 Epoch 21 | average train loss: 2.8086
2023-33-07 18:33:12 INFO     	 Epoch 21 | average valid loss: 4.3650
2023-33-07 18:33:30 INFO     	 Epoch 22 | average train loss: 2.8053
2023-33-07 18:33:30 INFO     	 Epoch 22 | average valid loss: 4.4113
2023-33-07 18:33:48 INFO     	 Epoch 23 | average train loss: 2.8021
2023-33-07 18:33:48 INFO     	 Epoch 23 | average valid loss: 4.4573
2023-34-07 18:34:06 INFO     	 Epoch 24 | average train loss: 2.7994
2023-34-07 18:34:06 INFO     	 Epoch 24 | average valid loss: 4.4984
2023-34-07 18:34:22 INFO     MRR: 0.545, Hits@1: 0.425, Hits@3: 0.621, Hits@10: 0.764 
2023-34-07 18:34:39 INFO     	 Epoch 25 | average train loss: 2.7969
2023-34-07 18:34:40 INFO     	 Epoch 25 | average valid loss: 4.5359
2023-34-07 18:34:57 INFO     	 Epoch 26 | average train loss: 2.7946
2023-34-07 18:34:58 INFO     	 Epoch 26 | average valid loss: 4.5724
2023-35-07 18:35:15 INFO     	 Epoch 27 | average train loss: 2.7927
2023-35-07 18:35:16 INFO     	 Epoch 27 | average valid loss: 4.6078
2023-35-07 18:35:33 INFO     	 Epoch 28 | average train loss: 2.7907
2023-35-07 18:35:34 INFO     	 Epoch 28 | average valid loss: 4.6418
2023-35-07 18:35:51 INFO     	 Epoch 29 | average train loss: 2.7894
2023-35-07 18:35:52 INFO     	 Epoch 29 | average valid loss: 4.6696
2023-36-07 18:36:07 INFO     MRR: 0.544, Hits@1: 0.424, Hits@3: 0.620, Hits@10: 0.763 
2023-36-07 18:36:24 INFO     	 Epoch 30 | average train loss: 2.7873
2023-36-07 18:36:24 INFO     	 Epoch 30 | average valid loss: 4.7008
2023-36-07 18:36:42 INFO     	 Epoch 31 | average train loss: 2.7859
2023-36-07 18:36:42 INFO     	 Epoch 31 | average valid loss: 4.7272
2023-37-07 18:37:00 INFO     	 Epoch 32 | average train loss: 2.7845
2023-37-07 18:37:00 INFO     	 Epoch 32 | average valid loss: 4.7519
2023-37-07 18:37:18 INFO     	 Epoch 33 | average train loss: 2.7831
2023-37-07 18:37:18 INFO     	 Epoch 33 | average valid loss: 4.7762
2023-37-07 18:37:36 INFO     	 Epoch 34 | average train loss: 2.7817
2023-37-07 18:37:36 INFO     	 Epoch 34 | average valid loss: 4.7977
2023-37-07 18:37:52 INFO     MRR: 0.542, Hits@1: 0.422, Hits@3: 0.619, Hits@10: 0.763 
2023-38-07 18:38:09 INFO     	 Epoch 35 | average train loss: 2.7806
2023-38-07 18:38:09 INFO     	 Epoch 35 | average valid loss: 4.8186
2023-38-07 18:38:27 INFO     	 Epoch 36 | average train loss: 2.7798
2023-38-07 18:38:27 INFO     	 Epoch 36 | average valid loss: 4.8408
2023-38-07 18:38:45 INFO     	 Epoch 37 | average train loss: 2.7789
2023-38-07 18:38:45 INFO     	 Epoch 37 | average valid loss: 4.8577
2023-39-07 18:39:03 INFO     	 Epoch 38 | average train loss: 2.7775
2023-39-07 18:39:03 INFO     	 Epoch 38 | average valid loss: 4.8747
2023-39-07 18:39:21 INFO     	 Epoch 39 | average train loss: 2.7771
2023-39-07 18:39:21 INFO     	 Epoch 39 | average valid loss: 4.8926
2023-39-07 18:39:36 INFO     MRR: 0.542, Hits@1: 0.422, Hits@3: 0.618, Hits@10: 0.762 
2023-39-07 18:39:36 INFO     	 Early stopping.
2023-39-07 18:39:36 INFO     	 Pretrain phase 1 optimization finished, get the best training epoch
2023-39-07 18:39:36 INFO     	 Start the pretrain phase 2: use all known data
2023-39-07 18:39:55 INFO     	 Epoch 0 | average train loss: 6.4380
2023-40-07 18:40:15 INFO     	 Epoch 1 | average train loss: 4.5145
2023-40-07 18:40:34 INFO     	 Epoch 2 | average train loss: 3.8310
2023-40-07 18:40:54 INFO     	 Epoch 3 | average train loss: 3.4269
2023-41-07 18:41:13 INFO     	 Epoch 4 | average train loss: 3.2036
2023-41-07 18:41:33 INFO     	 Epoch 5 | average train loss: 3.0834
2023-41-07 18:41:53 INFO     	 Epoch 6 | average train loss: 3.0167
2023-42-07 18:42:12 INFO     	 Epoch 7 | average train loss: 2.9781
2023-42-07 18:42:32 INFO     	 Epoch 8 | average train loss: 2.9537
2023-42-07 18:42:52 INFO     	 Epoch 9 | average train loss: 2.9371
2023-43-07 18:43:11 INFO     	 Epoch 10 | average train loss: 2.9255
2023-43-07 18:43:31 INFO     	 Epoch 11 | average train loss: 2.9166
2023-43-07 18:43:50 INFO     	 Epoch 12 | average train loss: 2.9096
2023-44-07 18:44:10 INFO     	 Epoch 13 | average train loss: 2.9041
2023-44-07 18:44:10 INFO     	 Pretrain phase 2 optimization finished.
2023-44-07 18:44:10 INFO     	 Saving model in logs/03_07/FB15K/QuatE_18_23_50.
2023-44-07 18:44:10 INFO     Continue completion: 0.9000 -> 0.99 Starts.
2023-44-07 18:44:10 INFO     	 generate relation filter
2023-44-07 18:44:10 INFO     	 relation filter generated successfully
